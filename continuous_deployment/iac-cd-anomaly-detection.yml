pool:
  name: Azure Pipelines

variables:
  azureml.resourceGroup: 'hsd_rg'
  azureml.workspaceName: 'hsd_ws'

steps:
- task: UsePythonVersion@0
  displayName: 'Use Python 3.6'
  inputs:
    versionSpec: 3.6

- task: Bash@3
  displayName: 'Bash Script'
  inputs:
    targetType: filePath
    filePath: './$(System.DefaultWorkingDirectory)/_CI-pipeline/hsd/deployment_setup/install_dependencies.sh'
    workingDirectory: '$(System.DefaultWorkingDirectory)/_CI-pipeline/hsd/deployment_setup'

- task: AzureCLI@2
  displayName: 'Add ML Extension'
  inputs:
    azureSubscription: 'azure-resource-connection'
    scriptType: bash
    scriptLocation: inlineScript
    inlineScript: 'az extension add -n azure-cli-ml'

- task: Bash@3
  displayName: 'Deploy to container'
  inputs:
    targetType: filePath
    filePath: './$(System.DefaultWorkingDirectory)/_CI-pipeline/hsd/deployment_setup/deploy.sh'
    workingDirectory: '$(System.DefaultWorkingDirectory)/_CI-pipeline/hsd/deployment_setup'